'use strict';

var BN = require('bn.js'),
    hash = require('./hash'),
    primal = require('primal').create();


var CERTAINTY = 64;

function createPrime(length) {
    length = length || 10;
    var prime = new BN(1).ishln((length + hash.SHA1_DIGEST_LENGTH) * 8);
    prime.iaddn(1);

    do {
        prime = prime.iaddn(2);
    } while (!primal.test(prime, CERTAINTY));

    return prime;
}


function divmod(num, den) {
    return [ Math.floor(num / den), Math.abs(num % den) ];
}


exports = module.exports = {

    createPrime: createPrime,

    divmod: divmod

};

