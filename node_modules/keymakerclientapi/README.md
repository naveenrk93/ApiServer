
##### VERSION 1 RELEASED ON MARCH 10, 2016
##### Last Updated this README in March 2017

##### For questions regarding integration with KeyMaker OR if you run into issues while using this module, contact: `#help-keymaker` channel on Slack or `DL-PP-KeyMaker-Team` via e-mail.
##### For key/keystore related questions/issues, please contact `DL-PP-KeyMaker-Ops` via e-mail.
##### Slack Chat URL: https://paypal.slack.com and join the `#help-keymaker` channel (our preferred way).
##### Confluence: `go/keymakerfaq`

What is this module?
========================================================================================================
keymakerclientapi is a module that needs to be added as a dependency in your application to harness its key management capability. In other words, developers can stop worrying about retrieving crypto keys from protected package or vault and concentrate on their application. This module will automatically retrieve the right key, its crypto algorithm, other crypto parameters internally and also provide APIs to perform crypto operations.

Facing PROD ISSUE !! Have no time to read the below?
========================================================================================================

Mail us at `DL-PP-KeyMaker-LiveSupport`

Ping us on `#help-keymaker` PayPal Slack channel


Get Started Right NOW
========================================================================================================

### I am a Newbie ..

Please follow the below links to get a full picture :
https://engineering.paypalcorp.com/confluence/display/PLATSEC/Node+KeyMaker+FAQs
https://engineering.paypalcorp.com/confluence/display/PLATSEC/KeyMaker+FAQs
https://engineering.paypalcorp.com/confluence/display/Altus/Security+Keys

### I am just a visitor (for a quick look) ..

### 1. Update `package.json` of your application

#### Front-tier apps

    - Bump to brogan@^4 or paypalize@^1.0.4 and above
    - Add keymakerclientapi@^1.0.0 and vault@^2||^3 dependencies

#### Mid-tier apps

    - Bump to typhon v2.1.0 and above
    - Add keymakerclientapi@^1.0.0 and vault@^2||^3 dependencies

### 2. GET `keymaker client object` in your code and use the crypto APIs

Here's your example snippet

```
var kmclient = require('keymakerclientapi').getClient();
// kmsclient can be used to invoke the crypto apis available in the keymaker module

var requestObject = {
    keyId: 'encrypted_test_cryptutil_crypt_key',
    data: new Buffer('testdata'),
    isPKCS7: false
};

kmclient.encrypt(requestObject, function (error, res) {
    //res.result.encodedData (gives you string- RFCBase64 encoded output)
});

```

More info on how to integrate/invoke crypto APIs:
https://engineering.paypalcorp.com/confluence/display/PLATSEC/Node+KeyMaker+FAQs


## PROUDLY PRESENTING - Crypto APIs that's gonna make your life easy ...

`keymakerclientapi` provides the following
* `encrypt`
* `decrypt`
* `hmac`
* `seal`
* `unseal`
* `getSecret`
* `sign`
* `verify`
* `jweEncrypt`
* `jweDecrypt`
* `jwsSign`
* `jwsVerify`
* `jwsRFCSign`

Additional info: encrypt/decrypt/hmac/seal/unseal/getSecret tries to provide crypto operation using the below falldown hierarchy
```
1. Get keys from keymaker to perform local crypto operation
    [if not .. we go to second approach]
2. Get Keys from protected (fallback) to perform local operation
    [if not.. we go to third approach]
3. make a secure TCP call to keymakeragent running on the same box
    (FOR DEV mode: keymakerclientapi is auto-configured to use a common keymakeragent pool. Simply means you don't have to worry about it!
    FOR STAGE/LIVE: keymakeragent will be bundled along with your altus application and deployed).
```

Additional info: sign/verify
```
We support these operations using keymakeragent but not localcrypto in release 1. 
The response SLA would be slightly higher than localcrypto scenario for this case.
```

Additional info: jweEncrypt/jweDecrypt/jwsSign/jwsVerify
```
These operations are supported locally only, not by keymakeragent.
Individual keypairs and certificates, as well as keypairs and certificates which are part of a keystore are supported, along with key rotation.
```

Additional info: Calling Cryptoserv Api
```
Starting 1.6.0, it is supported locally. Before that, there was no local support. It used to fall back to Keymakeragent.
Please check details in End User Doc: https://engineering.paypalcorp.com/confluence/display/PLATSEC/Node+KeyMaker+FAQs#NodeKeyMakerFAQs-TocallCryptoserv 
```
### Everything about keymaker internals:
######https://engineering.paypalcorp.com/confluence/display/PLATSEC/KeyMaker+-+Next+Gen+Key+Management


##### Wanna Contribute? Ensure the below tests are passing !!
----------------------------------------------------------------------------------------------------------
###To Run all tests at once
npm test

###To run keymakeragent locally (Not for our customers)

- Clone keymakeragent in to your local.
- Make sure you have the keymakeragent running in test mode.
- python KeyMakerAgent/tests/dev_run_all.py

###Have a Raptor/Helix/Cpp buddy who is stuck with any KeyMaker Issue?

You get them to hit --> https://go/km
